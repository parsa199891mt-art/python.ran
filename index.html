<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ویرایشگر آنلاین پایتون | محمد پارسا ولیان</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Pyodide for Python execution -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;400;700&display=swap');
        
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .code-editor {
            font-family: 'Courier New', Courier, monospace;
            resize: none;
            direction: ltr;
            tab-size: 4;
        }

        .console-output {
            font-family: 'Consolas', 'Monaco', monospace;
            direction: ltr;
            min-height: 150px;
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid #3b82f6;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden { display: none; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2">
                <i class="fab fa-python text-yellow-400 text-2xl"></i>
                <span>ویرایشگر آنلاین پایتون</span>
            </h1>
            <div id="status" class="text-sm flex items-center bg-slate-900 px-3 py-1 rounded-full text-blue-400">
                <div class="spinner" id="loading-spinner"></div>
                <span id="status-text">در حال بارگذاری مفسر پایتون...</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 flex flex-col gap-4">
        
        <!-- Editor Section -->
        <div class="flex-grow flex flex-col bg-slate-800 rounded-lg overflow-hidden border border-slate-700 shadow-xl">
            <div class="bg-slate-700 px-4 py-2 flex justify-between items-center">
                <span class="text-xs text-slate-400 font-mono uppercase">main.py</span>
                <button id="run-btn" disabled class="bg-green-600 hover:bg-green-500 disabled:bg-slate-600 text-white px-6 py-1 rounded font-bold transition-colors flex items-center gap-2">
                    <i class="fas fa-play"></i>
                    اجرای کد
                </button>
            </div>
            <textarea id="code-input" class="code-editor flex-grow bg-slate-900 text-green-400 p-4 outline-none border-none text-lg" spellcheck="false"># کد پایتون خود را اینجا بنویسید
print("سلام دنیا!")
name = "محمد پارسا ولیان"
print(f"طراح سایت: {name}")

for i in range(5):
    print(f"عدد: {i}")
</textarea>
        </div>

        <!-- Output Section -->
        <div class="h-1/3 min-h-[200px] flex flex-col bg-black rounded-lg overflow-hidden border border-slate-700">
            <div class="bg-slate-800 px-4 py-2 flex justify-between items-center">
                <span class="text-xs text-slate-400">خروجی کنسول</span>
                <button onclick="clearConsole()" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>
            <pre id="output" class="console-output p-4 overflow-y-auto text-sm leading-relaxed text-white whitespace-pre-wrap"></pre>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-800 p-6 mt-4">
        <div class="container mx-auto text-center">
            <p class="text-slate-400 text-sm md:text-base">
                تمامی حقوق این سایت برای <span class="text-white font-bold">محمد پارسا ولیان</span> است
            </p>
            <div class="flex justify-center gap-4 mt-3 text-slate-500">
                <i class="fab fa-github hover:text-white cursor-pointer"></i>
                <i class="fab fa-linkedin hover:text-white cursor-pointer"></i>
                <i class="fas fa-envelope hover:text-white cursor-pointer"></i>
            </div>
        </div>
    </footer>

    <script>
        let pyodide;
        const outputElement = document.getElementById('output');
        const runBtn = document.getElementById('run-btn');
        const statusText = document.getElementById('status-text');
        const spinner = document.getElementById('loading-spinner');

        // Initialize Pyodide
        async function main() {
            try {
                pyodide = await loadPyodide();
                statusText.innerText = "آماده برای اجرا";
                spinner.classList.add('hidden');
                runBtn.disabled = false;
                appendOutput("مفسر پایتون با موفقیت بارگذاری شد.\n");
            } catch (err) {
                statusText.innerText = "خطا در بارگذاری مفسر";
                appendOutput("خطا: " + err.message);
            }
        }
        main();

        function appendOutput(text) {
            outputElement.innerText += text + "\n";
            outputElement.scrollTop = outputElement.scrollHeight;
        }

        function clearConsole() {
            outputElement.innerText = "";
        }

        runBtn.addEventListener('click', async () => {
            const code = document.getElementById('code-input').value;
            clearConsole();
            appendOutput("--- در حال اجرا... ---");
            
            try {
                // Redirect stdout to our console
                pyodide.setStdout({
                    batched: (str) => {
                        appendOutput(str);
                    }
                });

                await pyodide.runPythonAsync(code);
                appendOutput("\n--- اجرای برنامه به پایان رسید ---");
            } catch (err) {
                appendOutput("\n[خطای پایتون]:\n" + err.message);
            }
        });

        // Add Tab key support to textarea
        document.getElementById('code-input').addEventListener('keydown', function(e) {
            if (e.key == 'Tab') {
                e.preventDefault();
                var start = this.selectionStart;
                var end = this.selectionEnd;
                this.value = this.value.substring(0, start) + "    " + this.value.substring(end);
                this.selectionStart = this.selectionEnd = start + 4;
            }
        });
    </script>
</body>
</html>
